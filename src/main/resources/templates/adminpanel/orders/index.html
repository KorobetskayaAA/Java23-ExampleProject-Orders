<!DOCTYPE html>
<html lang="ru" class="h-100" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head th:insert="~{../fragments/layout :: headFragment}">
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Orders - Админпанель - Заказы</title>
  </head>
  <body class="d-flex flex-column h-100">
  <header th:replace="~{../fragments/layout :: header('Java23. Orders - Заказы')}"></header>

    <nav class="navbar navbar-expand-sm navbar-dark bg-secondary">
      <div class="container-lg">
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
          aria-controls="navbarNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item">
                <a class="nav-link" href="../items/index.html" th:href="@{/adminpanel/items}"
                >Товары</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="#">Заказы</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <main class="flex-shrink-0">
      <div class="container-lg">
        <div class="m-2">
            <a class="btn btn-primary" href="create.html" th:href="@{orders/create}">
            <i class="bi bi-cart-plus-fill"></i> Новый заказ
          </a>
        </div>
          <div class="m-2 alert alert-danger" th:text="${alert}" th:hidden="${alert == null}"></div>
        <div class="table-responsive">
          <table class="table table-bordered table-sm">
            <thead class="table-primary">
              <tr>
                <th scope="col">Номер</th>
                <th scope="col">Дата и время создания</th>
                <th scope="col">Заказчик</th>
                <th scope="col">Кол-во позиций</th>
                <th scope="col">Сумма, руб.</th>
                <th scope="col">Статус</th>
                <th scope="col">Действие</th>
              </tr>
            </thead>
            <tbody>
            <tr th:each="order : ${orders}">
                <td th:text="${order.id}">50</td>
                <td th:text="${#temporals.format(order.order.created, 'dd.MM.yyyy HH:mm:ss')}">19.02.2023 09:02:54</td>
                <td th:text="${order.order.customerName}">Тихонова Мария</td>
                <td th:text="${order.getItemsCount()}" class="text-end">1</td>
                <td th:text="${#numbers.formatCurrency(order.getTotalAmount())}" class="text-end">14&nbsp;308,56</td>
                <td th:text="${order.order.status.title}">Выполнен</td>
                <td class="text-center">
                    <div class="d-flex justify-content-evenly"
                         th:if="${order.order.status.isEditable()}">
                        <a class="nav-item text-primary" title="Закрыть"
                           th:href="@{'orders/close/' + ${order.id}}"
                        ><i class="bi bi-bookmark-check-fill"></i
                    ></a>
                        <a class="nav-item text-danger" title="Отменить"
                           th:href="@{'orders/cancel/' + ${order.id}}"
                        ><i class="bi bi-bookmark-x-fill"></i
                    ></a>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
          <div class="m-2">
              <nav aria-label="products-navigation" th:if="${pagesCount} > 0">
                  <ul class="pagination justify-content-end">
                      <li class="page-item">
                          <button class="page-link" onclick="setParam('page', 0)">&laquo;</button>
                      </li>
                      <li th:each="page: ${#numbers.sequence(1, pagesCount)}" class="page-item active"
                          th:class="${page} == ${currentPage} ? 'active' : ''">
                          <button class="page-link" th:onclick="'setParam(`page`,' +${page}+ ')'" th:text="${page}">1
                          </button>
                      </li>
                      <li class="page-item">
                          <button class="page-link" onclick="setParam('page', 5)"
                                  th:onclick="setParam('page', ${pagesCount})">&laquo;
                          </button>
                      </li>
                  </ul>
              </nav>
          </div>
      </div>
    </main>

  <footer th:replace="~{../fragments/layout :: footer}"></footer>
  </body>
</html>
